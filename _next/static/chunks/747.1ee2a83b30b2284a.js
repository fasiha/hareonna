"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[747],{393:function(r,t,n){n.r(t),n.d(t,{default:function(){return O}});var e=n(5893),o=(n(5254),n(5715),n(3592),n(6417)),a=n(2013),i=n(577),u=n(2604),c=(n(5732),n(1512)),l=n(5243),f=n.n(l);function s(r,t){(null==t||t>r.length)&&(t=r.length);for(var n=0,e=new Array(t);n<t;n++)e[n]=r[n];return e}function m(r,t,n){return t in r?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n,r}function p(r){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},e=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(n).filter((function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})))),e.forEach((function(t){m(r,t,n[t])}))}return r}function y(r,t){if(null==r)return{};var n,e,o=function(r,t){if(null==r)return{};var n,e,o={},a=Object.keys(r);for(e=0;e<a.length;e++)n=a[e],t.indexOf(n)>=0||(o[n]=r[n]);return o}(r,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);for(e=0;e<a.length;e++)n=a[e],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(r,n)&&(o[n]=r[n])}return o}function d(r,t){return function(r){if(Array.isArray(r))return r}(r)||function(r,t){var n=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var e,o,a=[],i=!0,u=!1;try{for(n=n.call(r);!(i=(e=n.next()).done)&&(a.push(e.value),!t||a.length!==t);i=!0);}catch(c){u=!0,o=c}finally{try{i||null==n.return||n.return()}finally{if(u)throw o}}return a}}(r,t)||function(r,t){if(!r)return;if("string"===typeof r)return s(r,t);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(r,t)}(r,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var h=(0,c.Au)((function(r,t){r.children;var n=y(r,["children"]),e={},o={};Object.entries(n).forEach((function(r){var t=d(r,2),n=t[0],a=t[1];return n.startsWith("on")?o[n]=a:e[n]=a}));var a=f().markerClusterGroup(e);return Object.entries(o).forEach((function(r){var t=d(r,2),n=t[0],e=t[1],o="cluster".concat(n.substring(2).toLowerCase());a.on(o,e)})),{instance:a,context:p({},t,{layerContainer:a})}})),b=n(7294),v=n(8048);function g(r,t){(null==t||t>r.length)&&(t=r.length);for(var n=0,e=new Array(t);n<t;n++)e[n]=r[n];return e}function j(r){return function(r){if(Array.isArray(r))return g(r)}(r)||function(r){if("undefined"!==typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function(r,t){if(!r)return;if("string"===typeof r)return g(r,t);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(r,t)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var O=function(r){var t,n=r.camera,c=n.center,l=n.pointsToFit,s=r.stationsPayload.stations,m=r.setStation,p=r.setSimilarTo,y=r.stationsInPage,d=r.pickedAndSimilarStations,g=r.numPicked,O=r.targetStation,S=(0,b.useState)(null),w=S[0],k=S[1],x=(0,b.useMemo)((function(){return(0,e.jsxs)(o.h,{ref:k,center:c,zoom:2,className:"mapContainer",children:[(0,e.jsx)(a.I,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,e.jsx)(h,{children:s.map((function(r,n){return(0,e.jsx)(i.J,{position:[r.lat,r.lon],children:(0,e.jsxs)(u.G,{minWidth:100,children:[r.name,": ",r.desc," (",((t=Math).min.apply(t,j(r.summary.goods))/r.summary.days*100).toFixed(1),"% available over ",r.summary.days," days)"," ",(0,e.jsx)("button",{onClick:function(){return m(r)},children:"Pick"})," ",(0,e.jsx)("button",{onClick:function(){return p(r)},children:"Find similar"})]})},n)}))})]})}),[]);return(0,b.useEffect)((function(){w&&(l.length?w.fitBounds(l,{animate:!0}):w.setView(c,w.getZoom(),{animate:!0}))}),[c,l,w]),(0,b.useEffect)((function(){if(w){var r=d.slice(0,g).map((function(r,t){return f().circleMarker((0,v.J)(r),{color:"orange",weight:3,opacity:.75,radius:9}).addTo(w).bindPopup("(".concat(t+1,")"))}));if(O){var t=new Set(y.map((function(r){return r.val.name}))),n=d.slice(g);r=r.concat(n.map((function(r,n){return f().circleMarker((0,v.J)(r),{fillColor:"orange",fillOpacity:t.has(r.name)?.5:.25,radius:t.has(r.name)?5:3,stroke:!1}).addTo(w).bindPopup("#".concat(n+1," Similar"))})));var e=n.map((function(r,n){return f().polyline([(0,v.J)(O),(0,v.J)(r)],{color:"orange",opacity:t.has(r.name)?.5:.25}).addTo(w).bindPopup("#".concat(n+1," Similar"))})),o=n.map((function(r,n){return t.has(r.name)?f().marker((0,v.J)(r),{icon:f().divIcon({html:"#".concat(n+1),className:"text-below-similar"})}).addTo(w):void 0}));return function(){r.forEach((function(r){return r.remove()})),e.forEach((function(r){return r.remove()})),o.forEach((function(r){return null===r||void 0===r?void 0:r.remove()}))}}return function(){r.forEach((function(r){return r.remove()}))}}}),[w,y,d,g,O]),(0,e.jsx)(e.Fragment,{children:x})}}}]);